var base_url="http://172.168.40.111:5005",request_submit=base_url+"/submit",request_result=base_url+"/result",submit_type=0,sol_type=0,byte_type=1,sol1_type=2,sol2_type=3;$("#analysis_start").click(function(){var e=window.cm.getValue();$("#content_analysis").fadeOut(),$("#loading_main").show();var t=!1;if(submit_type===sol_type){var n=$("#check0").prop("checked"),a=$("#check1").prop("checked"),s=$("#check2").prop("checked");console.log("check",n,a,s);var c=null;$.post(request_submit,{type:1,reentrancy:n,mislocking:a,multisig:s,code:e},function(e,n){if(t=!0,console.log("requestStat"),c=e.task,t){console.log("requestStat");var a=setInterval(function(){$.get(request_result+"?task="+c,function(e,t){if("success"===t){console.log("data",e),console.log("textStatus",t);var n=e.results,s=e.error;if(console.log("result",n),0!==s)return;var c=[],l=[];n.forEach(function(e){l.push(e.lines),e.lines.forEach(function(e){c.push(e)})});var i=_.uniq(c,!0);if($("#loading_main").hide(),n[0]){$("#pattern_result_arrows").addClass("matched"),$("#call_stack_label").text(n[0].description),$("#title1").text(n[0].name),$("#callStack_input").text("Input: "+n[0].input);o="";l[0].forEach(function(e){o+="L"+e+" "}),$("#callStack_matchline").text("Matched lines: "+o)}else $("#category1").fadeOut();if(n[1]){$("#pattern_result_bug").addClass("matched"),$("#concurrency_label").text(n[1].description),$("#title2").text(n[1].name),$("#concurrency_input").text("Input: "+n[1].input);o="";l[1].forEach(function(e){o+="L"+e+" "}),$("#concurrency_matchline").text("Matched lines: "+o)}else $("#category2").fadeOut();if(n[2]){$("#pattern_result_filter").addClass("matched"),$("#reentrancy_label").text(n[2].description),$("#title3").text(n[2].name),$("#reentrancy_input").text("Input: "+n[2].input);o="";l[2].forEach(function(e){o+="L"+e+" "}),$("#reentrancy_matchline").text("Matched lines: "+o)}else $("#category3").fadeOut();if(n[3]){$("#pattern_result_refresh").addClass("matched"),$("#time_dependency_label").text(n[3].description),$("#title4").text(n[3].name),$("#time_input").text("Input: "+n[3].input);var o="";l[3].forEach(function(e){o+="L"+e+" "}),$("#time_matchline").text("Matched lines: "+o)}else $("#category4").fadeOut();$("#content_analysis").fadeIn(),highlightLine(i)}clearInterval(a)})},200)}})}}),$("#btn-solidity").click(function(){submit_type=sol_type,$("#btn-solidity").addClass("active"),$("#btn-bytecode").removeClass("active"),$("#btn-sample1").removeClass("active"),window.cm.setValue("contract SimpleBank { \n    mapping(address => uint) balances;\n    function deposit(uint amount) {\n      balances[msg.sender] += amount;\n  }\n\n    function withdraw() {\n      msg.sender.call.value(balances[msg.sender])();\n   }\n\n}")}),$("#btn-sample1").click(function(){submit_type=sol1_type,$("#btn-bytecode").removeClass("active"),$("#btn-solidity").removeClass("active"),$("#btn-sample1").addClass("active"),window.cm.setValue("contract EtherBank4 {\n  mapping(address => uint) balances;\n  bool locked;\n  function deposit() public payable {\n    balances[msg.sender] += msg.value;\n  }\n  function withdraw(uint amount) public {\n    lock();\n    if (balances[msg.sender] >= amount) {\n      if (!msg.sender.call.value(amount)()) revert();\n      balances[msg.sender] -= amount;\n    }\n    unlock();\n  }\n  function lock() {\n    if (!locked)\n      locked = true;\n    else\n    revert();\n    }\n    function unlock() {\n      locked = false;\n    }\n}")});